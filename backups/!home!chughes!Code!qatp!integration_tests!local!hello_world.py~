#!/usr/bin/python

import sys
from os import path

loc = path.realpath(path.dirname(path.dirname(path.dirname(__file__))))
sys.path.append(loc)

from qatp_core.qatp.core import QATPCore
qatp_config = {
    'infrastructure': {
        'key_filename': '/home/chughes/.ssh/id_qatp_stacks'
    }
}
if len(sys.argv) > 1:
    qatp_config['state'] = {'dryrun': True}

qatp = QATPCore(qatp_config)

run_config = {
    'datasets': ["en-oef-834k"],
    'stacks': [
        {
            'blueprint': "cdh450-3",
            'type': 'hadoop',
            'title': 'batchtest-hbase'
        }
    ],
    'artifact': "https://nexus.corp.digitalreasoning.com/nexus/service/local/artifact/maven/redirect?r=releases&g=com.digitalreasoning.synthesys&a=synthesys-dist&v=3.8.1&p=tar.gz"
}
qatp.new_run('ingest.hbase_batch', run_config=run_config, use_queues=False)
